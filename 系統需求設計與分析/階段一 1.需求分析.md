> 需求設計分析
> 2025/10/20
> 我是一家公司的資安官，在公司裡負責與ISO27001:2022 相關的工作，並且也要回覆客戶詢問相關的問題，
> 而你是一位頂尖的資安威脅分析師，也是一位企業資安諮詢的顧問，同時你也是AI應用的專家，
> 你的任務就是協助我完成每一次的需求與任務。
> 我現在需要一個能夠自動化定期收集資安情資整合與威脅分析，然後產生有用的分析報告。
> 1. 蒐集威脅情資：
> 2. 威脅分析，比對與內部資產的實際影響：
> 3. 產生分析報告：
> 4. 通知資安官。

##### 階段一：基礎建設與情資定義 (Foundation & T-PIR)
目標： 確立「我們關心什麼」以及「我們擁有什麼」。沒有這一步，所有的情資都是雜訊。

1. 盤點與建立「內部資產清冊 (Asset Inventory)」
    - 任務： 這是威脅分析的核心。我們必須有一個 即時且可機讀的 資產清冊。
    - 執行：
        - 整合現有的 CMDB、VMware/Proxmox 清單、雲端 (AWS/Azure/GCP) 儀表板、AD 等。
        - 利用端點掃描工具 (如 Nmap, OpenVAS 或商業工具)定期主動發現新資產。
        - 關鍵資料： IP、主機名稱、作業系統(含版本)、運行的應用程式(含版本)、負責人、資料敏感度、是否對外 (Public-facing)。
    - 產出： 一個集中的、可被 API 查詢的資產資料庫。
2. 定義「優先情資需求 (Priority Intelligence Requirements, PIR)」
   - 任務： 明確定義我們需要監控的威脅類型。
   - 執行： 依據您的業務特性、行業別、技術堆疊 (Tech Stack) 來決定。
     - 範例：
       - 影響我們正在使用的 Proxmox VE / VMware 的 0-day 漏洞。
       - 針對台灣金融/科技業的 TTPs (戰術、技術與程序)。
       - 冒充我們公司品牌的釣魚網站或域名。
       - 影響我們 C# / React / MSSQL 等核心應用的嚴重漏洞。
   - 產出：PIR 需求文件，作為情資收集的關鍵字與過濾器。
3. 選擇與訂閱「威脅情資來源 (Threat Feeds)」
   - 任務： 建立情資收集的管道。
   - 執行：
     - 公開來源 (OSINT)：
       - 台灣： TW-CERT/CC (Email/RSS), TWCERT/CC
       - 國際： CISA (Known Exploited Vulnerabilities - KEV), NVD (CVEs)
       - 特定： MITRE ATT&CK, GitHub (PoC 專案), 惡意軟體情資 (MalwareBazaar)
       - 商業來源 (選用)： CrowdStrike, Recorded Future, Mandiant (若預算許可)
   - 產出： 情資來源清單及其 API / Feed 存取方式。

---

##### 階段二：自動化收集與關聯分析 (Automation & Correlation)
目標： 打造系統的大腦，自動執行您的第1、2項需求。
1. 建置「情資收集代理人 (Collection Agent)」
   - 任務： 自動化爬取階段一的來源。
     - 執行：
       - 開發一系列的 Python 腳本或使用自動化平台 (如 n8n, Zapier, 或自建 AI Agent)。
       - 利用 API (如 NVD API) 定期 (例如：每小時) 抓取新情資。
       - 監控 RSS Feeds 和 Email (如 TW-CERT 的通報)。AI 應用： 使用 AI (如 LLM) 處理非結構化資料 (如：資安新聞、部落格)，將其摘要並提取關鍵 IOC (Indicators of Compromise) 和 CVE。
   - 產出： 一個集中的「原始情資資料庫 (Raw Intel DB)」。
2. 開發「關聯與風險評分引擎 (Correlation & Scoring Engine)」
   - 任務： 實現「比對與內部資產的實際影響」。
     - 執行：
       - 關聯 (Correlation)：
         - Foreach 每一筆新情資 (如：CVE-2025-XXXX 影響 Windows Server 2022 v1.5)。
         - Query 內部資產資料庫 (「我們有哪些主機符合此條件？」)。
       - 評分 (Scoring)：
         - IF 找不到匹配資產 THEN Risk = 0 (僅記錄)。
         - IF 找到匹配資產 THEN 計算風險分數：
         - 基礎分： CVSS 分數 (來自 NVD)。
         - 情境加權：
           - 是否對外？ (x 1.5)
           - 是否為關鍵系統 (C-level)？ (x 1.3)
           - CISA KEV 是否提及 (已被積極利用)？ (x 2.0)
     - 產出：一個「已驗證威脅清單 (Validated Threats List)」，包含受影響的資產、風險分數和狀態。

--- 
##### 階段三：報告生成與即時通知 (Reporting & Notification)
目標： 將分析結果轉化為行動，並通知正確的人 (原始專案規劃的 第3、4項需求)。
1. 設計「自動化報告模板」
   - 任務：
     - 模板A (高階主管/CISO 摘要)： (每週)
       - 圖表：本週新增關鍵威脅數、已修復數。
       - 摘要：Top 3 需立即關注的威脅及其潛在業務衝擊。
       - AI 應用：使用 AI 將技術細節彙總為 100 字的「風險摘要」。
     - 模板B (技術團隊工單)： (即時)
       - 受影響資產 (IP/主機名)。
       - 威脅描述 (CVE)。
       - 建議修補措施 (Patch 連結、緩解措施)。
   - 產出：HTML (Email) / PDF / Markdown 格式的報告模板。
2. 建立「通知與追蹤工作流 (Notification & Tracking Workflow)」
   - 任務：確保資安官被通知，且威脅被處理。
     - 常規通知 (資安官)： 每週自動發送「模板A」報告到您的信箱。
     - 緊急通知 (資安官 + IT 團隊)：
       - IF 關聯分析後的風險分數 > 9.0 (例如：已被積極利用 + 影響對外主機)。
       - THEN 立即發送 Email + Teams/Slack 警報。
       - AND 自動在 IT 維運系統 (如 Jira, ServiceNow) 建立一個高優先級 Ticket (模板B 內容)。
   - 產出：完整的自動化通知流程。

--- 
##### 階段四：持續維運與優化 (Operation & PDCA)
目標： 確保此系統持續有效，並符合 ISO 27001 的 PDCA (Plan-Do-Check-Act) 循環。
1. 監控與維護 (Check)：
   - 定期檢查資產清冊的準確性 (非常重要！)。
   - 監控情資來源是否中斷。
   - 審視 AI 摘要的品質。
2. 審查與改進 (Act)：
   - 誤報/漏報分析： 每月審查，調整「風險評分模型」的權重。
   - 情資來源更新： 根據新的 PIR (例如公司導入了新技術)，增加新的情資來源。
   - 流程整合： 將此流程的產出 (報告) 正式納入 ISO 27001 的管理審查會議。

--- 

##### AI 在此計劃中的關鍵角色
。 自然語言處理 (NLP)： 自動閱讀非結構化的資安新聞、部落格、TWCERT 通報，提取 CVE 編號、TTPs 和受影響的產品。
。 威脅摘要： 自動將複雜的漏洞分析，總結為易於 CISO 和高管理解的「業務風險描述」。
。 模式識別： (進階) 分析大量 IOCs，識別出針對貴公司的潛在攻擊活動 (Campaign)。

##### 階段五：增加可更改定時蒐集或手動立即蒐集
1. 可手動立即進行威脅情資的蒐集。
2. 可變更威脅情資蒐集的間隔時間（每隔幾小時(1、2、3、4、6、12)、幾分鐘(5、10、15、20、30)。
3. 以網頁相關資訊：
   1. 上面1/3處顯示「今天日期＋現在時間」、下次蒐集時間和倒數時間，和「手動立即執行按鈕」。
   2. 中間1/3處威脅情資蒐集來源，及顯示「AETIM 立即觸發收集任務」的訊息，及「啟動關聯分析引擎」的訊息。
   3. 下面1/3處顯示分析報告及通知訊息。
   4. 